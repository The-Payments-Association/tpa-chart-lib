<!DOCTYPE html>
<html>
<head>
    <title>Test Minified Line Chart</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .debug-info {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
            white-space: pre-line;
        }
        .chart-container {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
            min-height: 450px;
        }
    </style>
</head>
<body>
    <h1>Minified Line Chart Test</h1>
    
    <div class="debug-info" id="debug-info">Loading dependencies...</div>

    <div class="test-container">
        <h2>Test 1: Single Line Chart</h2>
        <div id="chart-1" class="chart-container"></div>
    </div>

    <div class="test-container">
        <h2>Test 2: Multi-Line Chart</h2>
        <div id="chart-2" class="chart-container"></div>
    </div>

    <div class="test-container">
        <h2>Test 3: Large Dataset (Mobile Pagination)</h2>
        <div id="chart-3" class="chart-container"></div>
    </div>

    <!-- Load React 18 -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script>
        let debugLog = '';
        
        function log(message) {
            debugLog += message + '\n';
            document.getElementById('debug-info').textContent = debugLog;
            console.log(message);
        }

        // Initial dependency check
        log('üîç Checking dependencies...');
        log('React version: ' + (React ? React.version : 'NOT LOADED'));
        log('ReactDOM available: ' + (!!ReactDOM));
        log('ReactDOM.createRoot available: ' + !!(ReactDOM && ReactDOM.createRoot));
        log('');
    </script>
    
    <!-- Load your actual minified line chart library -->
    <script src="./dist/line-payments-charts.min.js"></script>
    
    <script>
        // Wait a moment for the script to load, then testhttp://192.168.1.245:3000
        setTimeout(function() {
            log('üì¶ Checking PaymentsCharts after load...');
            log('window.PaymentsCharts type: ' + typeof window.PaymentsCharts);
            
            if (window.PaymentsCharts) {
                log('PaymentsCharts object keys: ' + Object.keys(window.PaymentsCharts).join(', '));
                log('PaymentsCharts.render type: ' + typeof window.PaymentsCharts.render);
                log('PaymentsCharts.renderLineChart type: ' + typeof window.PaymentsCharts.renderLineChart);
            } else {
                log('‚ùå window.PaymentsCharts is not available');
            }
            log('');
            
            // Test the charts
            runChartTests();
        }, 500);

        function runChartTests() {
            log('üöÄ Starting line chart tests...');
            
            // Test data
            const singleLineData = [
                { name: "Q1 2024", volume: 145000 },
                { name: "Q2 2024", volume: 162000 },
                { name: "Q3 2024", volume: 158000 },
                { name: "Q4 2024", volume: 171000 }
            ];

            const multiLineData = [
                { name: "Q1 2024", volume: 145000, value: 32060 },
                { name: "Q2 2024", volume: 162000, value: 42150 },
                { name: "Q3 2024", volume: 158000, value: 43320 },
                { name: "Q4 2024", volume: 171000, value: 46840 }
            ];

            const largeDataset = [
                { name: "Jan 2024", volume: 145000, value: 32060 },
                { name: "Feb 2024", volume: 162000, value: 42150 },
                { name: "Mar 2024", volume: 158000, value: 43320 },
                { name: "Apr 2024", volume: 171000, value: 46840 },
                { name: "May 2024", volume: 189000, value: 51200 },
                { name: "Jun 2024", volume: 203000, value: 56780 },
                { name: "Jul 2024", volume: 195000, value: 54300 },
                { name: "Aug 2024", volume: 187000, value: 52100 },
                { name: "Sep 2024", volume: 201000, value: 58200 },
                { name: "Oct 2024", volume: 215000, value: 61800 },
                { name: "Nov 2024", volume: 208000, value: 59400 },
                { name: "Dec 2024", volume: 225000, value: 65000 }
            ];

            // Test 1: Single line chart
            log('üìà Testing single line chart...');
            try {
                if (window.PaymentsCharts && window.PaymentsCharts.renderLineChart) {
                    window.PaymentsCharts.renderLineChart('chart-1', {
                        data: singleLineData,
                        title: 'Single Line Test Chart',
                        height: 400,
                        sourceText: 'Test data source'
                    });
                    log('‚úÖ Single line chart render called successfully');
                } else if (window.PaymentsCharts && window.PaymentsCharts.render) {
                    // Fallback to generic render method
                    window.PaymentsCharts.render('chart-1', {
                        data: singleLineData,
                        title: 'Single Line Test Chart (fallback)',
                        height: 400,
                        sourceText: 'Test data source'
                    });
                    log('‚úÖ Single line chart render called successfully (fallback)');
                } else {
                    log('‚ùå PaymentsCharts.renderLineChart not available');
                    document.getElementById('chart-1').innerHTML = '<p style="color: red;">PaymentsCharts.renderLineChart not available</p>';
                }
            } catch (error) {
                log('üí• Single line chart error: ' + error.message);
                document.getElementById('chart-1').innerHTML = '<p style="color: red;">Error: ' + error.message + '</p>';
            }

            // Test 2: Multi-line chart
            setTimeout(() => {
                log('üìà Testing multi-line chart...');
                try {
                    if (window.PaymentsCharts && window.PaymentsCharts.renderLineChart) {
                        window.PaymentsCharts.renderLineChart('chart-2', {
                            data: multiLineData,
                            title: 'Multi-Line Test Chart',
                            height: 400,
                            sourceText: 'Test data source',
                            fieldLabels: {
                                volume: 'Payment Volume',
                                value: 'Transaction Value (¬£m)'
                            }
                        });
                        log('‚úÖ Multi-line chart render called successfully');
                    } else {
                        log('‚ùå PaymentsCharts.renderLineChart not available for second chart');
                        document.getElementById('chart-2').innerHTML = '<p style="color: red;">PaymentsCharts.renderLineChart not available</p>';
                    }
                } catch (error) {
                    log('üí• Multi-line chart error: ' + error.message);
                    document.getElementById('chart-2').innerHTML = '<p style="color: red;">Error: ' + error.message + '</p>';
                }
            }, 1000);

            // Test 3: Large dataset
            setTimeout(() => {
                log('üìà Testing large dataset with pagination...');
                try {
                    if (window.PaymentsCharts && window.PaymentsCharts.renderLineChart) {
                        window.PaymentsCharts.renderLineChart('chart-3', {
                            data: largeDataset,
                            title: 'Large Dataset Test (12 Months)',
                            height: 400,
                            sourceText: 'Test data source - monthly data',
                            notesDescription: 'This chart demonstrates mobile pagination for large datasets. On mobile devices, this will show pagination controls.'
                        });
                        log('‚úÖ Large dataset chart render called successfully');
                    } else {
                        log('‚ùå PaymentsCharts.renderLineChart not available for third chart');
                        document.getElementById('chart-3').innerHTML = '<p style="color: red;">PaymentsCharts.renderLineChart not available</p>';
                    }
                } catch (error) {
                    log('üí• Large dataset chart error: ' + error.message);
                    document.getElementById('chart-3').innerHTML = '<p style="color: red;">Error: ' + error.message + '</p>';
                }
            }, 2000);
        }

        // Test direct access
        window.testDirect = function() {
            log('üîß Direct test function called');
            console.log('Direct window.PaymentsCharts:', window.PaymentsCharts);
        };

        // Test window resize (for responsive behavior)
        window.testResize = function() {
            log('üì± Testing responsive behavior...');
            // Simulate mobile width
            document.body.style.width = '375px';
            setTimeout(() => {
                window.dispatchEvent(new Event('resize'));
                log('üì± Resize event triggered (mobile simulation)');
            }, 100);
        };
    </script>
</body>
</html>